import("graphic");

graphic.init_graphic();

width = 800;
height = 600;

graphic.set_width(width);
graphic.set_height(height);

graphic.show_window();

graphic.fill_window(45, 45, 45);
graphic.update_window();

maxIterations = 256;
minReal = -2;
maxReal = 1;
minImag = -1;
maxImag = 1;

for (y from 0 to height - 1) {
    for (x from 0 to width - 1) {

        real = minReal + (maxReal - minReal) * (x / width);
        imag = minImag + (maxImag - minImag) * (y / height);
        
        iterations = {
            zReal = 0;
            zImag = 0;
            for (i from 1 to maxIterations) {
                zReal2 = zReal * zReal;
                zImag2 = zImag * zImag;
                zImag = 2 * zReal * zImag + imag;
                zReal = zReal2 - zImag2 + real;
                if (zReal2 + zImag2 > 4) {
                    return i;
                }
            }
            return maxIterations;
        };

        r = 8 * iterations;
        g = 0;
        b = 15 * iterations;

        graphic.set_pixel(x, y, r, g, b);
    }
}
